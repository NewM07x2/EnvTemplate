File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete


File "/usr/local/lib/python3.12/site-packages/uvicorn/server.py", line 69, in serve


await self._serve(sockets)


File "/usr/local/lib/python3.12/site-packages/uvicorn/server.py", line 76, in _serve


config.load()


File "/usr/local/lib/python3.12/site-packages/uvicorn/config.py", line 434, in load


self.loaded_app = import_from_string(self.app)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/uvicorn/importer.py", line 19, in import_from_string


module = importlib.import_module(module_str)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/importlib/__init__.py", line 90, in import_module


return _bootstrap._gcd_import(name[level:], package, level)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "<frozen importlib._bootstrap>", line 1387, in _gcd_import


File "<frozen importlib._bootstrap>", line 1360, in _find_and_load


File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked


File "<frozen importlib._bootstrap>", line 935, in _load_unlocked


File "<frozen importlib._bootstrap_external>", line 999, in exec_module


File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed


File "/app/main.py", line 10, in <module>


from app.api.v1 import api_router


File "/app/app/__init__.py", line 3, in <module>


from app.core.config import settings


File "/app/app/core/__init__.py", line 3, in <module>


from app.core.config import settings


File "/app/app/core/config.py", line 112, in <module>


settings = get_settings()


^^^^^^^^^^^^^^


File "/app/app/core/config.py", line 108, in get_settings


return Settings()


^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/main.py", line 153, in __init__


**__pydantic_self__._settings_build_values(


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/main.py", line 357, in _settings_build_values


source_state = source()


^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 973, in __call__


data: dict[str, Any] = super().__call__()


^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 547, in __call__


raise SettingsError(


pydantic_settings.sources.SettingsError: error parsing value for field "ALLOWED_ORIGINS" from source "DotEnvSettingsSource"


2
Environment variables loaded from .env


Prisma schema loaded from prisma/schema.prisma


Datasource "db": PostgreSQL database "fastapi_db", schema "public" at "postgres:5432"




The database is already in sync with the Prisma schema.




Running generate... (Use --skip-generate to skip the generators)


Running generate... - Prisma Client Python (v0.15.0)


✔ Generated Prisma Client Python (v0.15.0) to ./../usr/local/lib/python3.12/site


-packages/prisma in 91ms




INFO: Will watch for changes in these directories: ['/app']


INFO: Uvicorn running on http://0.0.0.0:8000⁠ (Press CTRL+C to quit)


INFO: Started reloader process [57] using WatchFiles


Process SpawnProcess-1:


Traceback (most recent call last):


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 545, in __call__


field_value = self.prepare_field_value(field_name, field, field_value, value_is_complex)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 757, in prepare_field_value


raise e


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 754, in prepare_field_value


value = self.decode_complex_value(field_name, field, value)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic_settings/sources.py", line 307, in decode_complex_value


return json.loads(value)


^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/json/__init__.py", line 346, in loads


return _default_decoder.decode(s)


^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/json/decoder.py", line 338, in decode


obj, end = self.raw_decode(s, idx=_w(s, 0).end())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/json/decoder.py", line 356, in raw_decode


raise JSONDecodeError("Expecting value", s, err.value) from None


json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)




The above exception was the direct cause of the following exception:




Traceback (most recent call last):


File "/usr/local/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap


self.run()


File "/usr/local/lib/python3.12/multiprocessing/process.py", line 108, in run


self._target(*self._args, **self._kwargs)


# 再ビルドして起動（最も簡単）
docker-compose up -d --build
docker-compose logs -f app


# .env ファイルが /app/.env にある想定で確認
docker-compose exec app cat /app/.env
```
(base) mnitta@MasatonoMacBook-Pro FastAPI % docker-compose exec app cat /app/.env
WARN[0000] /Users/mnitta/devlop/EnvTemplate/python/FastAPI/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
# Application
APP_NAME=FastAPI Template
APP_VERSION=0.1.0
APP_ENV=development
DEBUG=True

# Server
HOST=0.0.0.0
PORT=8000

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/fastapi_db
# For SQLite (Development)
# DATABASE_URL=sqlite:///./app.db

# Security
SECRET_KEY=your-secret-key-here-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000
ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH
ALLOWED_HEADERS=*

# Redis (Optional - for caching and task queue)
REDIS_URL=redis://localhost:6379/0

# Celery (Optional - for background tasks)
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Logging
LOG_LEVEL=INFO
```


# 環境変数の現状を確認
docker-compose exec app env | Select-String ALLOWED_ORIGINS

docker-compose up -d --build

3
class UserBase(BaseModel):


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_model_construction.py", line 223, in __new__


complete_model_class(


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_model_construction.py", line 568, in complete_model_class


schema = cls.__get_pydantic_core_schema__(cls, handler)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/main.py", line 670, in __get_pydantic_core_schema__


return handler(source)


^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_schema_generation_shared.py", line 83, in __call__


schema = self._handler(source_type)


^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 655, in generate_schema


schema = self._generate_schema_inner(obj)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 924, in _generate_schema_inner


return self._model_schema(obj)


^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 739, in _model_schema


{k: self._generate_md_field_schema(k, v, decorators) for k, v in fields.items()},


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 1115, in _generate_md_field_schema


common_field = self._common_field_schema(name, field_info, decorators)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 1308, in _common_field_schema


schema = self._apply_annotations(


^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 2104, in _apply_annotations


schema = get_inner_schema(source_type)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_schema_generation_shared.py", line 83, in __call__


schema = self._handler(source_type)


^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 2083, in inner_handler


from_property = self._generate_schema_from_property(obj, source_type)


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py", line 821, in _generate_schema_from_property


schema = get_schema(


^^^^^^^^^^^


File "/usr/local/lib/python3.12/site-packages/pydantic/networks.py", line 459, in __get_pydantic_core_schema__


import_email_validator()


File "/usr/local/lib/python3.12/site-packages/pydantic/networks.py", line 421, in import_email_validator


raise ImportError('email-validator is not installed, run `pip install pydantic[email]`') from e


ImportError: email-validator is not installed, run `pip install pydantic[email]`